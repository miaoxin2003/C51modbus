# C51 Modbus 温湿度监控系统

这是一个基于 C51 单片机的 Modbus RTU 通信项目，用于实现温湿度数据的采集、传输和控制。系统包含一个主站（Host）和多个从站（Slave）。

## 功能

### 主站 (Host)

*   **Modbus RTU 通信**：作为 Modbus 主站，通过 RS485 接口轮询连接的从站。
*   **温湿度数据采集**：从从站获取 DHT11 传感器采集的温湿度数据。
*   **LCD 显示**：在 LCD1602 液晶显示屏上实时显示从不同从站获取的温湿度数据。
*   **环境控制**：根据接收到的温湿度数据，控制连接的执行器（如风扇、蜂鸣器、LED 和加湿器），实现环境的自动调节。
    *   **温度控制**：
        *   当温度高于 28°C 时，开启冷风扇，关闭蜂鸣器，红灯亮，黄灯和绿灯灭。
        *   当温度为 26°C 时，冷风扇和热风扇都关闭，蜂鸣器开启，绿灯亮。
        *   当温度高于 27°C 时，开启冷风扇，黄灯亮，蜂鸣器开启，绿灯灭。
        *   当温度低于 25°C 时，开启热风扇，黄灯亮，蜂鸣器开启，绿灯灭。
        *   当温度低于 23°C 时，开启热风扇，关闭蜂鸣器，红灯亮，黄灯和绿灯灭。
    *   **湿度控制**：
        *   当湿度为 60% 时，开启加湿器。
        *   当湿度低于 58% 或高于 62% 时，关闭加湿器。

### 从站 (Slave)

*   **Modbus RTU 通信**：作为 Modbus 从站，响应主站的 Modbus 04H 功能码（读取输入寄存器）请求。
*   **温湿度数据采集**：通过 DHT11 温湿度传感器采集环境的实时温湿度数据。
*   **节点地址配置**：从站的 Modbus 地址通过跳线（P3.2 和 P3.3）进行配置。

## 硬件要求

*   **C51 单片机**：例如 STC89C52 或 AT89C52。
*   **RS485 模块**：基于 MAX485 芯片，用于实现 TTL 到 RS485 的电平转换。
*   **LCD1602 液晶显示屏**：用于主站显示温湿度信息。
*   **DHT11 温湿度传感器**：用于从站采集温湿度数据。
*   **执行器**：
    *   风扇（冷风扇和热风扇）
    *   蜂鸣器
    *   LED（红、绿、黄）
    *   加湿器

## 软件要求

*   **Keil uVision**：用于 C51 单片机程序的编译和烧录。

## 文件结构

*   `readme.md`：项目说明文件。
*   `仿真 (1)/`：包含 Proteus 仿真文件和编译后的 `.hex` 文件。
    *   `Test.pdsprj`：Proteus 仿真项目文件。
    *   `Master.hex`：主站程序的烧录文件。
    *   `Slave.hex`：从站程序的烧录文件。
    *   `DHT11 Simulation.hex`：DHT11 仿真程序的烧录文件。
*   `源程序/M/`：主站的源代码目录。
    *   `HOST.c`：主站的主要 C 语言源代码。
    *   `Master.uvproj`：Keil uVision 主站项目文件。
*   `源程序/S/`：从站的源代码目录。
    *   `SLAVE.c`：从站的主要 C 语言源代码。
    *   `Slave.uvproj`：Keil uVision 从站项目文件。

## 编译与烧录

1.  使用 Keil uVision 打开 `源程序/M/Master.uvproj`（主站）和 `源程序/S/Slave.uvproj`（从站）项目。
2.  分别编译主站和从站项目，生成 `.hex` 文件。
3.  将生成的 `.hex` 文件烧录到相应的 C51 单片机中。

## 使用说明

1.  **硬件连接**：按照电路图连接 C51 单片机、MAX485 模块、LCD1602、DHT11 传感器、风扇、蜂鸣器、LED 和加湿器。
2.  **从站地址配置**：根据需要，通过从站的跳线（P3.2 和 P3.3）设置从站的 Modbus 地址。
3.  **上电运行**：给系统上电，主站将开始轮询从站，并在 LCD 上显示温湿度数据，同时根据数据控制执行器。
4.  **Proteus 仿真**：可以使用 `仿真 (1)/Test.pdsprj` 文件在 Proteus 中进行仿真测试。